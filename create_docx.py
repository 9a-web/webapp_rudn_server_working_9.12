
from docx import Document
from docx.shared import Pt, RGBColor
from docx.enum.text import WD_ALIGN_PARAGRAPH

def create_document():
    doc = Document()

    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    title = doc.add_heading('–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞ RUDN Schedule', 0)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER

    # 1. –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞
    doc.add_heading('1. –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞', level=1)
    
    items_1 = [
        ("–°–£–ë–î:", "MongoDB (–≤–µ—Ä—Å–∏—è 6.0+)."),
        ("–¢–∏–ø:", "NoSQL, –î–æ–∫—É–º–µ–Ω—Ç–æ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è."),
        ("–î—Ä–∞–π–≤–µ—Ä:", "Motor (Asynchronous Python driver) ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞."),
        ("–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:", "BSON (Binary JSON). –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ –≥–∏–±–∫–∏—Ö JSON-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ React.")
    ]
    
    for label, text in items_1:
        p = doc.add_paragraph(style='List Bullet')
        p.add_run(label + " ").bold = True
        p.add_run(text)

    # 2. –ü–æ—á–µ–º—É MongoDB
    doc.add_heading('2. –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–Ω–∞ –∏–º–µ–Ω–Ω–æ MongoDB?', level=1)
    
    items_2 = [
        ("–ì–∏–±–∫–æ—Å—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:", "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä —É —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è. MongoDB –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å \"—Ä–∞–∑–Ω—ã–µ\" –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –±–µ–∑ –∂–µ—Å—Ç–∫–æ–π —Å—Ö–µ–º—ã (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç SQL)."),
        ("–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:", "–î–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤ JSON –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è \"–∫–∞–∫ –µ—Å—Ç—å\", –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π."),
        ("–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:", "–ë–∞–∑–∞ –ª–µ–≥–∫–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á.")
    ]
    
    for label, text in items_2:
        p = doc.add_paragraph(style='List Bullet')
        p.add_run(label + " ").bold = True
        p.add_run(text)

    # 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞
    doc.add_heading('3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–ö–æ–ª–ª–µ–∫—Ü–∏–∏)', level=1)
    doc.add_paragraph("–í–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ö–æ–ª–ª–µ–∫—Ü–∏–∏. –ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ 5 –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π:")

    # –ú–æ–¥—É–ª–∏
    modules = [
        ("üë§ –ú–æ–¥—É–ª—å \"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏\" (user_settings)", [
            ("–•—Ä–∞–Ω–∏—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞."),
            ("–ö–ª—é—á: telegram_id (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)."),
            ("–î–∞–Ω–Ω—ã–µ: –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç, –∫—É—Ä—Å, –≥—Ä—É–ø–ø–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π."),
            ("–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≥—Ä—É–ø–ø–µ.")
        ]),
        ("üìÖ –ú–æ–¥—É–ª—å \"–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –ö—ç—à\" (schedule_cache)", [
            ("–ß—Ç–æ–±—ã –Ω–µ \"–±–æ–º–±–∏—Ç—å\" —Å–∞–π—Ç –†–£–î–ù –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ –±–∞–∑—É."),
            ("–ü—Ä–∏–Ω—Ü–∏–ø: \"Lazy Loading\" —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º."),
            ("TTL (Time-To-Live): –ó–∞–ø–∏—Å–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è 1 —á–∞—Å, –∑–∞—Ç–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.")
        ]),
        ("üìù –ú–æ–¥—É–ª—å \"–ó–∞–¥–∞—á–∏ –∏ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ\" (tasks)", [
            ("–õ–∏—á–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å—Ç—É–¥–µ–Ω—Ç–∞."),
            ("–°–≤—è–∑–∏: –ü—Ä–∏–≤—è–∑–∞–Ω—ã –∫ telegram_id."),
            ("–§–∏—à–∫–∏: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—É—á–µ–±–∞/–ª–∏—á–Ω–æ–µ), –¥–µ–¥–ª–∞–π–Ω—ã –∏ —Å—Ç–∞—Ç—É—Å—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.")
        ]),
        ("ü§ù –ú–æ–¥—É–ª—å \"–°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞\" (rooms, group_tasks)", [
            ("–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –¥–ª—è –≥—Ä—É–ø–ø —Å—Ç—É–¥–µ–Ω—Ç–æ–≤."),
            ("Rooms: –•—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–Ω–∞—Ç—ã."),
            ("Group Tasks: –ó–∞–¥–∞—á–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–Ω–∞—Ç—ã."),
            ("–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –í–ª–æ–∂–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.")
        ]),
        ("üéì –ú–æ–¥—É–ª—å \"–¶–∏—Ñ—Ä–æ–≤–æ–π –ñ—É—Ä–Ω–∞–ª\" (journals, attendance_records)", [
            ("–°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã."),
            ("Journals: –ú–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ –∂—É—Ä–Ω–∞–ª–∞ (–ø—Ä–µ–¥–º–µ—Ç, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å)."),
            ("Journal Students: –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (–≤–∫–ª—é—á–∞—è \"–ø—Ä–∏–∑—Ä–∞–∫–æ–≤\")."),
            ("Attendance: –ó–∞–ø–∏—Å–∏ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.")
        ])
    ]

    for title, points in modules:
        doc.add_heading(title, level=2)
        for point in points:
            doc.add_paragraph(point, style='List Bullet')

    # 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
    doc.add_heading('4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏', level=1)

    tech_points = [
        ("UUID –≤–º–µ—Å—Ç–æ ObjectId", "–ú—ã –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö ID MongoDB –≤ –ø–æ–ª—å–∑—É UUID. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, –æ–±–ª–µ–≥—á–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∏ –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å."),
        ("–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è (Optimization)", "–í –±–∞–∑–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã \"–∫–∞—Ä—Ç–æ—Ç–µ–∫–∏\" (B-Tree –∏–Ω–¥–µ–∫—Å—ã). –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 0.001 —Å–µ–∫. –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤—Ä–µ–º—è —Ä–æ—Å–ª–æ –±—ã –ª–∏–Ω–µ–π–Ω–æ."),
        ("–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å", "–ë–∞–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–º —Ä–µ–∂–∏–º–µ. –°–µ—Ä–≤–µ—Ä –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å–æ—Ç–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.")
    ]

    for i, (label, text) in enumerate(tech_points, 1):
        p = doc.add_paragraph()
        p.add_run(f"{i}. {label}: ").bold = True
        p.add_run(text)

    # –í—ã–≤–æ–¥
    doc.add_heading('–í—ã–≤–æ–¥', level=1)
    p = doc.add_paragraph()
    runner = p.add_run("–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö NoSQL —Ä–µ—à–µ–Ω–∏—è—Ö, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É –≤—Å–µ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.")
    runner.italic = True

    doc.save('/app/RUDN_DB_Architecture.docx')
    print("Document created successfully")

if __name__ == "__main__":
    create_document()
